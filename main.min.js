/**
 * Copyright (c) 2024 DeAundre Payne
 * 
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program. If not, see <https://www.gnu.org/licenses/>.
 *
 * @module dom-matrix
 * @license GPL-3.0
 **/
const _2DKeys=[0,1,4,5,12,13],aliasKeys=["a","b","c","d","e","f"],dataSymbol=Symbol("data"),setIsIdentitySymbol=Symbol("setIsIdentity");let readOnly=!0;export class DOMMatrixReadOnly{is2D=!0;isIdentity=!0;a=0;b=0;c=0;d=0;e=0;f=0;m11=0;m12=0;m13=0;m14=0;m21=0;m22=0;m23=0;m24=0;m31=0;m32=0;m33=0;m34=0;m41=0;m42=0;m43=0;m44=0;constructor(t){if(this[dataSymbol]=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this[dataSymbol].isIdentity=!0,void 0!==t)if(t instanceof DOMMatrixReadOnly==!0){this.is2D=t.is2D;for(let e=0;e<16;e++)this[dataSymbol][e]=t[dataSymbol][e]}else{if(void 0===t.length)throw new ReferenceError("init.length must be defined");if(6!==t.length&&16!==t.length)throw new RangeError("init.length must equal 6 or 16");for(let e=0;e<t.length;e++){if(void 0===t[e])throw new ReferenceError(`init[${e}] must be defined`);"number"!=typeof t[e]&&(t[e]=Number(t[e]))}if(6===t.length)for(let e=0;e<_2DKeys.length;e++)this[dataSymbol][_2DKeys[e]]=t[e];else{this.is2D=!1;for(let e=0;e<16;e++)this[dataSymbol][e]=t[e]}}for(let t=0;t<16;t++)if(t%5==0)1!==this[dataSymbol][t]&&(this[dataSymbol].isIdentity=!1);else if(0!==this[dataSymbol][t]){this[dataSymbol].isIdentity=!1;break}for(let t=0;t<aliasKeys.length;t++)this[aliasKeys[t]]=this[dataSymbol][_2DKeys[t]];if(!0===readOnly){for(let t=0;t<4;t++)for(let e=0;e<4;e++)this[`m${t+1}${e+1}`]=this[dataSymbol][4*t+e];this.isIdentity=this[dataSymbol].isIdentity,Object.freeze(this)}else{readOnly=!0;for(let t=0;t<4;t++)for(let e=0;e<4;e++)delete this[`m${t+1}${e+1}`];delete this.isIdentity,delete this.a,delete this.b,delete this.c,delete this.d,delete this.e,delete this.f}}[setIsIdentitySymbol](){1===this[dataSymbol][0]&&0===this[dataSymbol][1]&&0===this[dataSymbol][2]&&0===this[dataSymbol][3]&&0===this[dataSymbol][4]&&1===this[dataSymbol][5]&&0===this[dataSymbol][6]&&0===this[dataSymbol][7]&&0===this[dataSymbol][8]&&0===this[dataSymbol][9]&&1===this[dataSymbol][10]&&0===this[dataSymbol][11]&&0===this[dataSymbol][12]&&0===this[dataSymbol][13]&&0===this[dataSymbol][14]&&1===this[dataSymbol][15]?this[dataSymbol].isIdentity=!0:this[dataSymbol].isIdentity=!1}flipX(){const t=new DOMMatrix(this);return t[dataSymbol][0]*=-1,t[dataSymbol][1]*=-1,t[dataSymbol][2]*=-1,t[dataSymbol][3]*=-1,t}flipY(){const t=new DOMMatrix(this);return t[dataSymbol][4]*=-1,t[dataSymbol][5]*=-1,t[dataSymbol][6]*=-1,t[dataSymbol][7]*=-1,t}multiply(t){if(void 0===t)throw new ReferenceError("other must be defined");if(t instanceof DOMMatrixReadOnly==!1)throw new TypeError("other must be a DOMMatrixReadOnly");const e=new DOMMatrix(this);for(let i=0;i<4;i++)for(let s=0;s<4;s++){let a=0;for(let e=0;e<4;e++)a+=this[dataSymbol][4*e+i]*t[dataSymbol][4*s+e];e[dataSymbol][4*s+i]=a,i===s?1!==e[dataSymbol][i]&&(e[dataSymbol].isIdentity=!1):0!==e[dataSymbol][i]&&(e[dataSymbol].isIdentity=!1)}return e}toFloat64Array(){return new Float64Array(this[dataSymbol])}}export class DOMMatrix extends DOMMatrixReadOnly{constructor(t){readOnly=!1,super(t)}get isIdentity(){return this[dataSymbol].isIdentity}set isIdentity(t){}get a(){return this[dataSymbol][0]}set a(t){"number"!=typeof t&&(t=Number(t)),1!==(this[dataSymbol][0]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get b(){return this[dataSymbol][1]}set b(t){0!==(this[dataSymbol][1]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get c(){return this[dataSymbol][4]}set c(t){0!==(this[dataSymbol][4]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get d(){return this[dataSymbol][5]}set d(t){1!==(this[dataSymbol][5]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get e(){return this[dataSymbol][12]}set e(t){0!==(this[dataSymbol][12]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get f(){return this[dataSymbol][13]}set f(t){0!==(this[dataSymbol][13]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m11(){return this[dataSymbol][0]}set m11(t){1!==(this[dataSymbol][0]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m12(){return this[dataSymbol][1]}set m12(t){0!==(this[dataSymbol][1]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m13(){return this[dataSymbol][2]}set m13(t){0!==(this[dataSymbol][2]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m14(){return this[dataSymbol][3]}set m14(t){0!==(this[dataSymbol][3]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m21(){return this[dataSymbol][4]}set m21(t){0!==(this[dataSymbol][4]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m22(){return this[dataSymbol][5]}set m22(t){1!==(this[dataSymbol][5]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m23(){return this[dataSymbol][6]}set m23(t){0!==(this[dataSymbol][6]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m24(){return this[dataSymbol][7]}set m24(t){0!==(this[dataSymbol][7]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m31(){return this[dataSymbol][8]}set m31(t){0!==(this[dataSymbol][8]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m32(){return this[dataSymbol][9]}set m32(t){0!==(this[dataSymbol][9]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m33(){return this[dataSymbol][10]}set m33(t){1!==(this[dataSymbol][10]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m34(){return this[dataSymbol][11]}set m34(t){0!==(this[dataSymbol][11]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m41(){return this[dataSymbol][12]}set m41(t){0!==(this[dataSymbol][12]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m42(){return this[dataSymbol][13]}set m42(t){0!==(this[dataSymbol][13]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m43(){return this[dataSymbol][14]}set m43(t){0!==(this[dataSymbol][14]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}get m44(){return this[dataSymbol][15]}set m44(t){1!==(this[dataSymbol][15]=t)?this[dataSymbol].isIdentity=!1:this[setIsIdentitySymbol]()}multiplySelf(t){if(void 0===t)throw new ReferenceError("other must be defined");if(t instanceof DOMMatrixReadOnly==!1)throw new TypeError("other must be a DOMMatrix");const e=[...this[dataSymbol]],i=t[dataSymbol];for(let t=0;t<4;t++)for(let s=0;s<4;s++){let a=0;for(let y=0;y<4;y++)a+=e[4*y+t]*i[4*s+y];this[dataSymbol][4*s+t]=a}return this}}